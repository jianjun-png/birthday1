<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>生日动画场景</title>
  <style>
    *{box-sizing:border-box;margin:0;padding:0}
    html,body{height:100%;overflow:hidden}
    body{
      background:linear-gradient(to bottom,#87CEEB 0%,#98D8E8 50%,#B0E0E6 100%);
      font-family:sans-serif;
      position:relative;
      min-height:100vh;
      overflow-x:hidden;
    }
    
    /* ===== 生日贺卡 ===== */
    .birthday-card{
      position:absolute;
      top:-650px;
      left:50%;
      transform:translateX(-50%);
      width:90%;
      max-width:1200px;
      height:auto;
      min-height:400px;
      aspect-ratio: 1200 / 650;
      background:#fff7f8;
      border-radius:16px;
      box-shadow:0 8px 20px rgba(0,0,0,.15);
      display:flex;
      flex-direction: column;
      align-items:center;
      justify-content:center;
      font-size:clamp(3rem, 8vw, 120px);
      font-weight:bold;
      color:#ff4777;
      transition:top .7s cubic-bezier(.68,-.55,.27,1.55);
      z-index:100;
      padding:20px;
    }

    .card-text {
      text-align: center;
      line-height: 1.2;
      margin: 20px 0;
    }
    
    .birthday-card.show{
      top:35%;
      transform:translate(-50%, -50%);
    }
    
    /* 贺卡小星星装饰 */
    .birthday-card::before{
      content:"✨";
      position:absolute;
      top:12px;
      left:20px;
      font-size:clamp(2rem, 5vw, 100px);
      opacity:.8;
    }
    
    .birthday-card::after{
      content:"✨";
      position:absolute;
      bottom:12px;
      right:20px;
      font-size:clamp(2.5rem, 6vw, 120px);
      opacity:.8;
    }
    
    /* 太阳 */
    .sun{
      position:absolute;
      top:clamp(60px, 8vw, 120px);
      right:clamp(200px, 25vw, 400px);
      width:clamp(200px, 25vw, 400px);
      height:clamp(200px, 25vw, 400px);
      background:radial-gradient(circle,#FFD700,#FFA500);
      border-radius:50%;
      box-shadow:0 0 60px #FFD700;
      animation:sun-glow 3s ease-in-out infinite alternate;
      z-index:5;
    }
    
    @keyframes sun-glow{
      from{box-shadow:0 0 60px #FFD700}
      to{box-shadow:0 0 90px #FFD700,0 0 120px #FFA500}
    }

    /* 云朵 */
    .cloud{
      position:absolute;
      background:white;
      border-radius:190px;
      opacity:.9;
      z-index:4;
    }
    
    .cloud::before,.cloud::after{
      content:'';
      position:absolute;
      background:white;
      border-radius:150px
    }
    
    .cloud1{
      width:clamp(225px, 28vw, 450px);
      height:clamp(110px, 14vw, 220px);
      top:15%;
      left:30%;
      animation:drift 17s linear infinite
    }
    
    .cloud1::before{
      width:clamp(130px, 16vw, 260px);
      height:clamp(130px, 16vw, 260px);
      top:-55px;
      left:25px
    }
    
    .cloud1::after{
      width:clamp(95px, 12vw, 190px);
      height:clamp(95px, 12vw, 190px);
      top:-30px;
      right:20px
    }
    
    .cloud2{
      width:clamp(165px, 21vw, 330px);
      height:clamp(70px, 9vw, 140px);
      top:20%;
      left:10%;
      margin-left: -200px;
      animation:drift 16s linear infinite reverse
    }
    
    .cloud2::before{
      width:clamp(130px, 16vw, 260px);
      height:clamp(95px, 12vw, 190px);
      top:-35px;
      left:25px
    }
    
    .cloud2::after{
      width:clamp(130px, 16vw, 260px);
      height:clamp(95px, 12vw, 190px);
      top:-25px;
      right:25px
    }
    
    @keyframes drift{
      from{transform:translateX(-350px)}
      to{transform:translateX(calc(100vw + 350px))}
    }

    /* 草坪 */
    .grass{
      position:absolute;
      bottom:0;
      width:100%;
      height:clamp(250px, 35vh, 500px);
      background:linear-gradient(to top,#228B22 0%,#32CD32 100%);
      z-index:6;
    }
    
    .grass::after{
      content:'🌱🌿🍃🌱🌿🍃🌱🌿🍃🌱🌿🍃🌱🌿🍃🌱🌿🍃🌱🌿🍃🌱🌿🍃🌱🌿🍃🌱🌿🍃🌱🌿🍃🌱🌿🍃';
      position:absolute;
      bottom:30px;
      left:0;
      width:100%;
      text-align:center;
      font-size:clamp(3rem, 8vw, 110px);
      letter-spacing:5px;
      opacity:0.8;
    }

    /* 人物区域 */
    .scene{
      position:absolute;
      bottom:clamp(140px, 20vh, 280px);
      left:0;
      right:0;
      height:clamp(350px, 50vh, 700px);
      display:flex;
      justify-content:space-between;
      align-items:flex-end;
      padding:0 clamp(60px, 10vw, 120px);
      z-index:7;
    }
    
    .char{
      height:clamp(950px, 135vh, 1900px);
      width:auto;
      user-select:none;
      filter:drop-shadow(0 4px 8px rgba(0,0,0,0.25));
      object-fit:contain;
    }
    
    .char:first-child {
      height: clamp(1250px, 178vh, 2500px);
    }
    
    /* 空投盒子 */
    .airdrop{
      position:absolute;
      left:50%;
      bottom:clamp(100px, 15vh, 200px);
      transform:translateX(-50%);
      height:clamp(650px, 92vh, 1300px);
      cursor:pointer;
      transition:transform .3s ease, opacity .5s ease;
      z-index:10;
      object-fit:contain;
    }
    
    .airdrop:hover{
      transform:translateX(-50%) scale(1.08)
    }

    /* 蛋糕 */
    .cake{
      position:absolute;
      left:50%;
      bottom:clamp(130px, 18vh, 260px);
      transform:translateX(-50%) scale(0);
      height:clamp(850px, 121vh, 1700px);
      opacity:0;
      transition:all .6s cubic-bezier(.68,-.55,.27,1.55);
      z-index:20;
      object-fit:contain;
    }
    
    .cake.show{
      transform:translateX(-50%) scale(1);
      opacity:1
    }

    /* 烟花 */
    .firework{
      position:absolute;
      width:8px;
      height:8px;
      border-radius:50%;
      pointer-events:none;
      opacity:0;
      z-index:30;
    }
    
    @keyframes explode{
      0%{transform:scale(0) translate(0,0);opacity:1}
      100%{transform:scale(30) translate(var(--dx),var(--dy));opacity:0}
    }
    
    /* 提示文字 */
    .hint{
      position:absolute;
      bottom:clamp(100px, 15vh, 200px);
      left:50%;
      transform:translateX(-50%);
      color:#fff;
      background:rgba(0,0,0,.4);
      padding:8px 16px;
      border-radius:20px;
      font-size:clamp(2rem, 5vw, 75px);
      pointer-events:none;
      animation:fade-in-out 4s ease-in-out infinite;
      white-space: nowrap;
      z-index:15;
    }
    
    @keyframes fade-in-out{
      0%,100%{opacity:.4}
      50%{opacity:1}
    }
    
    /* 太阳面部 */
    .sun-face {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      width: 200px;
      height: 180px;
      z-index: 2;
    }

    .sun-eyes {
      position: relative;
      width: 100%;
      height: 60px;
      display: flex;
      justify-content: space-around;
      align-items: center;
    }

    .sun-eye {
      width: 40px;
      height: 40px;
      background: #8B4513;
      border-radius: 50%;
      position: relative;
      animation: blink 4s infinite;
    }

    .sun-eye::after {
      content: '';
      position: absolute;
      width: 15px;
      height: 15px;
      background: white;
      border-radius: 50%;
      top: 8px;
      left: 10px;
    }

    @keyframes blink {
      0%, 45%, 55%, 100% { height: 40px; }
      48%, 52% { height: 5px; }
    }

    .sun-mouth {
      width: 80px;
      height: 30px;
      background: #8B4513;
      border-radius: 0 0 40px 40px;
      margin: 20px auto 0;
      position: relative;
      animation: mouth-move 3s ease-in-out infinite;
    }

    @keyframes mouth-move {
      0%, 100% { transform: scaleY(1); }
      50% { transform: scaleY(0.7); }
    }

    .sun-cheeks {
      position: absolute;
      top: 40px;
      left: 0;
      width: 100%;
      display: flex;
      justify-content: space-between;
    }

    .sun-cheek {
      width: 30px;
      height: 20px;
      background: rgba(255, 105, 180, 0.3);
      border-radius: 50%;
    }

    /* 庆祝小喇叭 */
    .party-horn {
      position: absolute;
      top: 55%;
      right: clamp(110px, 14vw, 220px);
      width: clamp(100px, 12.5vw, 200px);
      height: clamp(30px, 3.8vw, 60px);
      background: linear-gradient(45deg, #FF6B6B, #FFD166, #4ECDC4, #FF6B6B);
      border-radius: 30px 10px 10px 30px;
      transform: translateY(-50%) rotate(-10deg);
      opacity: 0;
      transition: all 0.5s ease 0.5s;
      z-index: 1;
      box-shadow: 0 4px 15px rgba(0,0,0,0.3);
      border: 3px solid #FFD700;
    }

    .party-horn::before {
      content: '';
      position: absolute;
      right: clamp(-20px, -2.5vw, -40px);
      top: 50%;
      transform: translateY(-50%);
      width: 0;
      height: 0;
      border-left: clamp(25px, 3.1vw, 50px) solid #FFD166;
      border-top: clamp(15px, 1.9vw, 30px) solid transparent;
      border-bottom: clamp(15px, 1.9vw, 30px) solid transparent;
      filter: drop-shadow(2px 0 5px rgba(0,0,0,0.2));
    }

    .party-horn::after {
      content: '🎊🎉✨';
      position: absolute;
      left: 15px;
      top: 50%;
      transform: translateY(-50%);
      font-size: clamp(15px, 1.9vw, 30px);
      animation: confetti-spin 2s ease-in-out infinite;
      text-shadow: 0 0 10px rgba(255,255,255,0.8);
    }
    
    .party-horn .horn-stripe {
      position: absolute;
      left: 0;
      top: 0;
      width: 100%;
      height: 100%;
      background: repeating-linear-gradient(
        45deg,
        transparent,
        transparent 8px,
        rgba(255,255,255,0.4) 8px,
        rgba(255,255,255,0.4) 16px
      );
      border-radius: 30px 10px 10px 30px;
      pointer-events: none;
      transform-origin: left center;
      transform: scaleX(0) skewX(-5deg);
      filter: brightness(1.2);
    }

    /* 喇叭吹出的气流效果 */
    .party-horn .air-flow {
      position: absolute;
      right: clamp(-40px, -5vw, -80px);
      top: 50%;
      transform: translateY(-50%);
      width: clamp(50px, 6.3vw, 100px);
      height: clamp(20px, 2.5vw, 40px);
      background: linear-gradient(90deg, rgba(255,255,255,0.8), transparent);
      border-radius: 20px;
      opacity: 0;
      animation: air-flow 1s ease-in-out infinite;
    }

    @keyframes confetti-spin {
      0%, 100% { 
        transform: translateY(-50%) rotate(0deg) scale(1);
      }
      25% { 
        transform: translateY(-50%) rotate(10deg) scale(1.1);
      }
      75% { 
        transform: translateY(-50%) rotate(-10deg) scale(1.1);
      }
    }

    @keyframes air-flow {
      0%, 100% { 
        opacity: 0;
        transform: translateY(-50%) scaleX(0.5);
      }
      25% { 
        opacity: 0.3;
        transform: translateY(-50%) scaleX(0.8);
      }
      50% { 
        opacity: 0.7;
        transform: translateY(-50%) scaleX(1.2);
      }
      75% { 
        opacity: 0.4;
        transform: translateY(-50%) scaleX(0.9);
      }
    }

    /* 激活状态下的条纹波浪展开效果 */
    .sun.active .party-horn .horn-stripe {
      animation: stripe-wave 1.5s ease-in-out infinite;
    }

    @keyframes stripe-wave {
      0% {
        transform: scaleX(0) skewX(-5deg);
        opacity: 0.6;
      }
      15% {
        transform: scaleX(0.2) skewX(0deg);
        opacity: 0.8;
      }
      30% {
        transform: scaleX(0.5) skewX(3deg);
        opacity: 1;
      }
      45% {
        transform: scaleX(0.8) skewX(-2deg);
        opacity: 1;
      }
      60% {
        transform: scaleX(1) skewX(0deg);
        opacity: 0.9;
      }
      75% {
        transform: scaleX(0.7) skewX(2deg);
        opacity: 0.8;
      }
      90% {
        transform: scaleX(0.3) skewX(-3deg);
        opacity: 0.7;
      }
      100% {
        transform: scaleX(0) skewX(-5deg);
        opacity: 0.6;
      }
    }
    
    /* 激活状态 */
    .sun.active .party-horn {
      opacity: 1;
      right: clamp(110px, 14vw, 220px);
      animation: horn-blow 1.2s ease-in-out infinite;
    }
    
    .sun.active .party-horn .air-flow {
      animation: air-flow 1.2s ease-in-out infinite;
    }

    @keyframes horn-blow {
      0%, 100% { 
        transform: translateY(-50%) rotate(-10deg) scale(1);
      }
      25% { 
        transform: translateY(-50%) rotate(-12deg) scale(1.02);
      }
      50% { 
        transform: translateY(-50%) rotate(-10deg) scale(1.05);
      }
      75% { 
        transform: translateY(-50%) rotate(-8deg) scale(1.02);
      }
    }

    /* 增强光晕效果 */
    .sun.active {
      animation: sun-glow-active 2s ease-in-out infinite alternate;
    }

    @keyframes sun-glow-active {
      from { 
        box-shadow: 0 0 80px #FFD700, 0 0 100px #FFA500;
      }
      to { 
        box-shadow: 0 0 120px #FFD700, 0 0 150px #FFA500, 0 0 180px #FF8C00;
      }
    }
    
    /* 移动设备优化 */
    @media (max-width: 768px) {
      .scene {
        justify-content: space-around;
        padding: 0 20px;
      }
      
      .char {
        height: clamp(475px, 67vh, 950px);
      }
      
      .char:first-child {
        height: clamp(625px, 89vh, 1250px);
      }
      
      .sun {
        right: 10%;
        top: 5%;
      }
      
      .grass::after {
        font-size: clamp(1.5rem, 4vw, 3rem);
      }
    }
  </style>
</head>
<body>
  <div class="sun" id="sun">
    <div class="sun-face">
      <div class="sun-eyes">
        <div class="sun-eye left-eye"></div>
        <div class="sun-eye right-eye"></div>
      </div>
      <div class="sun-mouth"></div>
      <div class="sun-cheeks">
        <div class="sun-cheek left-cheek"></div>
        <div class="sun-cheek right-cheek"></div>
      </div>
    </div>
    <div class="party-horn">
      <div class="horn-stripe"></div>
      <div class="air-flow"></div>
    </div>
  </div>
  
  <div class="cloud cloud1"></div>
  <div class="cloud cloud2"></div>
  <div class="grass"></div>

  <div class="scene">
    <img class="char" src="./乐乐.png" alt="乐乐" onerror="this.style.display='none'">
    <img class="char" src="./米老鼠.png" alt="米老鼠" onerror="this.style.display='none'">
  </div>

  <img class="airdrop" id="airdrop" src="./空投盒子.png" alt="空投盒子" onerror="this.style.display='none'">
  <img class="cake" id="cake" src="./生日蛋糕.png" alt="🎂" onerror="this.style.display='none'">

  <div class="hint">点击空投盒子开启惊喜</div>
  
  <div class="birthday-card" id="birthdayCard">
    <div class="card-text">祝佳雪生日快乐！</div>
    <div class="card-text">天天开心，万事顺意！</div>
  </div>
  
  <audio id="bgMusic" loop preload="auto">
    <source src="./生日快乐歌.mp3" type="audio/mp3">
    <source src="./生日快乐歌.m4a" type="audio/mp4">
    <source src="./生日快乐歌.ogg" type="audio/ogg">
  </audio>
  
  <script>
    const airdrop = document.getElementById('airdrop');
    const cake = document.getElementById('cake');
    const birthdayCard = document.getElementById('birthdayCard');
    const bgMusic = document.getElementById('bgMusic');
    
    // 检查图片是否加载成功
    function checkImages() {
      const images = document.querySelectorAll('img');
      let loadedCount = 0;
      
      images.forEach(img => {
        if (img.complete && img.naturalHeight !== 0) {
          loadedCount++;
        } else {
          img.addEventListener('load', () => {
            loadedCount++;
          });
          img.addEventListener('error', () => {
            console.log(`图片加载失败: ${img.src}`);
          });
        }
      });
    }
    
    // 页面加载完成后检查图片
    window.addEventListener('load', checkImages);
    
    airdrop.addEventListener('click', () => {
      // 尝试播放音乐
      bgMusic.volume = 0.6;
      bgMusic.play().catch(e => {
        console.log('音乐播放失败:', e);
        // 如果播放失败，尝试用户交互后播放
        document.body.addEventListener('click', function tryPlayMusic() {
          bgMusic.play().catch(err => console.log('重试播放失败:', err));
          document.body.removeEventListener('click', tryPlayMusic);
        });
      });
      
      // 隐藏空投盒子
      airdrop.style.transition = 'transform .5s ease, opacity .5s ease';
      airdrop.style.transform = 'translateX(-50%) scale(0)';
      airdrop.style.opacity = 0;
      
      // 激活太阳伯伯
      setTimeout(() => {
        document.getElementById('sun').classList.add('active');
      }, 300);
      
      // 显示蛋糕和贺卡
      setTimeout(() => {
        cake.classList.add('show');
        birthdayCard.classList.add('show');
      }, 400);
      
      // 发射烟花
      setTimeout(() => launchFireworks(), 800);
    });
    
    function launchFireworks() {
      const colors = ['#FF6B6B','#4ECDC4','#FFD166','#FF1493','#00CED1','#FF8C00','#ADFF2F','#FF00FF','#00FF00','#FFFF00'];
      
      // 第一波烟花
      for(let i = 0; i < 130; i++){  
        setTimeout(() => {
          const fw = document.createElement('div');
          fw.className = 'firework';
          fw.style.background = colors[i % colors.length];
          fw.style.left = Math.random() * window.innerWidth + 'px';
          fw.style.top = Math.random() * (window.innerHeight * 0.8) + 'px';
          fw.style.width = '12px';
          fw.style.height = '12px';
          fw.style.setProperty('--dx', (Math.random() - 0.5) * 600 + 'px');
          fw.style.setProperty('--dy', (Math.random() - 0.5) * 600 + 'px');
          fw.style.animation = 'explode 2s ease-out forwards';
          fw.style.boxShadow = '0 0 20px currentColor';
          document.body.appendChild(fw);
          setTimeout(() => fw.remove(), 4000);
        }, i * 60);
      }
      
      // 第二波烟花
      setTimeout(() => {
        for(let i = 0; i < 180; i++){
          setTimeout(() => {
            const fw = document.createElement('div');
            fw.className = 'firework';
            fw.style.background = colors[(i + 5) % colors.length];
            fw.style.left = Math.random() * window.innerWidth + 'px';
            fw.style.top = Math.random() * (window.innerHeight * 0.7) + 'px';
            fw.style.width = '15px';
            fw.style.height = '15px';
            fw.style.setProperty('--dx', (Math.random() - 0.5) * 500 + 'px');
            fw.style.setProperty('--dy', (Math.random() - 0.5) * 500 + 'px');
            fw.style.animation = 'explode 1.5s ease-out forwards';
            fw.style.boxShadow = '0 0 25px currentColor, 0 0 15px white';
            document.body.appendChild(fw);
            setTimeout(() => fw.remove(), 1500);
          }, i * 80);
        }
      }, 5000);
    }
  </script>
</body>
</html>
